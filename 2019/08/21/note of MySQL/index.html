<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>note of MySQL | Huangjingjingblog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="关键字1. distinctSELECT返回所有匹配的行。但是如果不想要每个值每次都出现，则可以用distinct只返回唯一的值 2. limit 限制 limit 5; 不多于5行  limit 5,5; 从 第5行开始不多于5行  带一个值的LIMIT总是从第一行开始，给出的数为返回的行数。带两个值的LIMIT可以指定从行号为第一个值的位置开始  是从0行开始计数的   3. order by">
<meta name="keywords" content="MySQL">
<meta property="og:type" content="article">
<meta property="og:title" content="note of MySQL">
<meta property="og:url" content="http://yoursite.com/2019/08/21/note of MySQL/index.html">
<meta property="og:site_name" content="Huangjingjingblog">
<meta property="og:description" content="关键字1. distinctSELECT返回所有匹配的行。但是如果不想要每个值每次都出现，则可以用distinct只返回唯一的值 2. limit 限制 limit 5; 不多于5行  limit 5,5; 从 第5行开始不多于5行  带一个值的LIMIT总是从第一行开始，给出的数为返回的行数。带两个值的LIMIT可以指定从行号为第一个值的位置开始  是从0行开始计数的   3. order by">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565712091949.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565712997819.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565713045472.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565713251518.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565715177143.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565715862096.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565716203378.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565716251010.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565838715955.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565838736215.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565840186859.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565840581796.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565840664625.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565841297599.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565841456741.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565841958500.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565842221998.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565842366822.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565842734801.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565843405018.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565843462684.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565843499649.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565843542002.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844081574.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844122044.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844156310.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844927380.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844962001.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845018878.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845120999.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845176197.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845459041.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845478087.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845533107.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845716642.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565846803676.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565847033790.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565847346777.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565856341486.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565856449366.png">
<meta property="og:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565857887624.png">
<meta property="og:updated_time" content="2019-08-21T05:00:15.501Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="note of MySQL">
<meta name="twitter:description" content="关键字1. distinctSELECT返回所有匹配的行。但是如果不想要每个值每次都出现，则可以用distinct只返回唯一的值 2. limit 限制 limit 5; 不多于5行  limit 5,5; 从 第5行开始不多于5行  带一个值的LIMIT总是从第一行开始，给出的数为返回的行数。带两个值的LIMIT可以指定从行号为第一个值的位置开始  是从0行开始计数的   3. order by">
<meta name="twitter:image" content="c:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565712091949.png">
  
    <link rel="alternate" href="/atom.xml" title="Huangjingjingblog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Huangjingjingblog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">welcome</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-note of MySQL" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/21/note of MySQL/" class="article-date">
  <time datetime="2019-08-21T01:54:29.110Z" itemprop="datePublished">2019-08-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      note of MySQL
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h2><h3 id="1-distinct"><a href="#1-distinct" class="headerlink" title="1. distinct"></a>1. distinct</h3><p>SELECT返回所有匹配的行。但是如果不想要每个值每次都出现，则可以用distinct<strong>只返回唯一的值</strong></p>
<h3 id="2-limit-限制"><a href="#2-limit-限制" class="headerlink" title="2. limit 限制"></a>2. limit 限制</h3><ul>
<li><p><code>limit 5;</code> 不多于5行</p>
</li>
<li><p><code>limit 5,5;</code> 从 第5行开始不多于5行</p>
</li>
<li><p>带一个值的LIMIT总是从第一行开始，给出的数为返回的行数。<br>带两个值的LIMIT可以指定从行号为第一个值的位置开始</p>
</li>
<li><p>是从<strong>0行</strong>开始计数的</p>
</li>
</ul>
<h3 id="3-order-by-排序"><a href="#3-order-by-排序" class="headerlink" title="3. order by 排序"></a>3. order by 排序</h3><ul>
<li><p><code>order by 列名</code></p>
</li>
<li><p>可以通过非选择列进行排序</p>
</li>
<li><p>按多个列排序<code>order by 列名1，列名2</code>若第一个列就是唯一的，则不会按第二个列排序</p>
</li>
<li><p>使用ORDER BY子句以降序（从Z到A）顺序排序。为了进行降序排序，必须指定<strong>DESC关键字</strong> 例如 <code>order by 列名1 DESC，列名2</code></p>
</li>
<li><p>如果既不指定ASC也不指定DESC，则假定为ASC</p>
</li>
<li><p>DESC关键字<strong>只</strong>应用到直接位于其前面的列名，如果想在多个列上进行降序排序，必须对每个列指定DESC关键字。</p>
</li>
<li><p>使用ORDER BY和LIMIT的组合，能够找出一个列中最高或最低的值。</p>
<p>仅选择一行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> prod_price</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> products</span><br><span class="line"></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_price <span class="keyword">DESC</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">limit</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>SELECT语句的ORDER BY子句对检索出的数据进行排序。</p>
<p><strong>这个子句必须是SELECT语句中的最后一条子句。</strong></p>
<p>可根据需要，利用它在一个或多个列上对数据进行排序。</p>
<a id="more"></a>

</li>
</ul>
<h3 id="4-where-过滤数据"><a href="#4-where-过滤数据" class="headerlink" title="4. where 过滤数据"></a>4. where 过滤数据</h3><ul>
<li><strong>讨论的问题</strong>：SQL过滤与应用过滤</li>
</ul>
<p>​       如果在客户机上过滤数据，服务器不得不通过网络发送多余的数据，这将导致网络带宽的浪费。</p>
<ul>
<li><p>在SELECT语句中，数据根据WHERE子句中指定的搜索条件进行过滤。</p>
</li>
<li><p><strong>WHERE子句的位置</strong> ：<strong>WHERE子句在表名（FROM子句）之后给出</strong>，在同时使用ORDER BY和WHERE子句时，<strong>ORDER BY位于WHERE之后</strong>，否则将会产生错误</p>
</li>
<li><p>范围值检查BETWEEN</p>
<p><code>where prod_price BETWEEN 5 AND 10;</code></p>
</li>
<li><p>空值检查</p>
<p><code>where prod_price IS NULL;</code></p>
</li>
<li><p>组合WHERE子句  </p>
<ul>
<li><p><strong>AND OR</strong></p>
<p><code>where vend_id = 1003 AND prod_price&lt;=10;</code></p>
<p>and与or：and优先，or若想优先用()括起来</p>
</li>
<li><p><strong>IN</strong>操作符用来指定条件范围，范围中的每个条件都可以进行匹配。</p>
<p><code>where vend_id  IN  (1003,1005)</code></p>
</li>
<li><p>NOT否定后跟条件的关键字。</p>
<p><code>where vend_id  NOT IN  (1003,1005)</code></p>
</li>
<li><p>MySQL支持使用<strong>NOT 对IN</strong> 、<strong>BETWEEN 和EXISTS</strong>子句取反，这与多数其他DBMS允许使用NOT对各种条件取反有很大的差别。</p>
</li>
</ul>
</li>
</ul>
<h3 id="5-用通配符过滤"><a href="#5-用通配符过滤" class="headerlink" title="5. 用通配符过滤"></a>5. 用通配符过滤</h3><ul>
<li><p><strong>LIKE操作符</strong></p>
<ul>
<li><p><strong>百分号（%）通配符</strong><br>最常使用的通配符是百分号（%）。在搜索串中，%表示任何字符出现<br>任意次数。例如，为了找出所有以词jet起头的产品，可使用以下SELECT<br>语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT prod_id, prod_name</span><br><span class="line">FROM products</span><br><span class="line">WHERE prod_name LIKE &apos;jet%&apos;;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>也可以<code>&#39;%jet%&#39;</code>匹配任何位置包含文本jet的值</p>
</li>
<li><p><code>WHERE prod_name LIKE &#39;%&#39;</code>不能匹配用值NULL作为产品名的行。</p>
</li>
</ul>
</li>
<li><p>下划线（_）通配符</p>
<p>下划线的用途与%一样，但下划线<strong>只匹配单个字符</strong>而不是多个字符</p>
</li>
</ul>
</li>
</ul>
<h3 id="5-MySQL-正则表达式"><a href="#5-MySQL-正则表达式" class="headerlink" title="5. MySQL 正则表达式"></a>5. MySQL 正则表达式</h3><ul>
<li><p><strong>基本字符匹配</strong></p>
<p><code>where prod_name REGEXP &#39;1000&#39;</code></p>
<p><strong>REGEXP</strong>后所跟的东西作为正则表达式（与文字正文1000匹配的一个正则表达式）处理</p>
</li>
<li><p><strong>LIKE与REGEXP</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">where prod_name LIKE '1000'</span><br><span class="line">where prod_name REGEXP '1000'</span><br></pre></td></tr></table></figure>

<ul>
<li>如果执行上述两条语句，会发现第一条语句不返回数据，而第二条语句返回一行。</li>
<li>LIKE匹配整个列。如果被匹配的文本在列值中出现，LIKE将不会找到它，相应的行也不被返回（除非使用通配符）。而REGEXP在列值内进行匹配，如果被匹配的文本在列值中出现，REGEXP将会找到它，相应的行将被返回。这是一个非常重要的差别。</li>
<li>MySQL中的正则表达式匹配（自版本3.23.4后）<strong>不区分大小写</strong>（即，大写和小写都匹配）。<strong>为区分大小写，可使用BINARY关键字</strong>，如WHERE prod_name <strong>REGEXP BINARY</strong> ‘JetPack .000’。</li>
</ul>
</li>
<li><p>进行OR匹配</p>
<p>为搜索两个串之一（或者为这个串，或者为另一个串），<strong>使用|</strong></p>
<p><code>where prod_name REGEXP &#39;1000|2000&#39;</code></p>
</li>
<li><p>匹配几个字符之一【】</p>
<ul>
<li><p>[]是另一种形式的OR语句</p>
</li>
<li><p>匹配任何单一字符，只想匹配特定的字符</p>
</li>
<li><p><code>where prod_name REGEXP &#39;[123] Ton&#39;</code></p>
</li>
</ul>
<p>​        返回 1 ton anvil , 2 ton anvil</p>
<p>​        事实上，正则表达式[123]Ton 为 [1|2|3]Ton的缩写</p>
</li>
<li><p>匹配范围</p>
<p><code>where prod_name REGEXP &#39;[1-5] Ton&#39;</code></p>
<p>由于5 ton匹配，所以返回  .5 ton  。</p>
</li>
<li><p>匹配特殊字符</p>
<p>为了匹配特殊字符，必须用转义\\为前导。\\-表示查找-，\\.表示查找.。</p>
<p><code>where prod_name REGEXP &#39;\\.&#39;</code></p>
<p>返回 Furball Inc.</p>
</li>
<li><p>匹配字符类</p>
</li>
<li><p>匹配多个实例</p>
<p>* 0或多个</p>
<p>+ 1或多个</p>
<p>?  0或1个</p>
<p>{n} 指定数目</p>
<p>{n,} 不少于指定数目的匹配</p>
<p>{n,m} 匹配数目的范围，m&lt;=255</p>
<ul>
<li><p>比如正则表达式<code>\\([0-9] sticks?\\)</code></p>
<p> \\(  匹配)，[0-9]匹配任意数字，sticks?匹配stick和sticks（<strong>s后的?使s可选</strong>，因为?匹配它前面的任何字符的0次或1次出现），\\)  匹配)。没有?，匹配stick和sticks会非常困难</p>
</li>
<li><p><code>[[:digit:]]{4}</code></p>
<p>{4}确切地要求它前面的字符（任意数字）出现4次，所以[[:digit:]]{4}匹配连在一起的任意4位数字</p>
</li>
</ul>
</li>
<li><p>定位符</p>
<p>^ 文本开始</p>
<p>$ 文本结尾</p>
<p>[[:&lt;:]] 词的开始</p>
<p>[[:&gt;:]] 词的结尾</p>
<p>例如<code>where prod_name REGEXP &#39;^[0-9\\.]&#39;</code>只在<em>.或任意数字</em>为串中第一个字符时才匹配它们。</p>
</li>
</ul>
<h2 id="chapter-10-创建计算字段"><a href="#chapter-10-创建计算字段" class="headerlink" title="chapter 10 创建计算字段"></a>chapter 10 创建计算字段</h2><ol>
<li>计算字段</li>
</ol>
<p>存储在表中的数据都不是应用程序所需要的。我们需要直接从数据库中检索出转换、计算或格式化过的数据；而不是检索出数据，然后再在客户机应用程序或报告程序中重新格式化。</p>
<ol start="2">
<li><p>拼接字段</p>
<p><strong>MySQL的不同之处</strong> ：</p>
<ul>
<li><p>多数DBMS使用+或||来实现拼接，<br>MySQL则使用Concat()函数来实现。当把SQL语句转换成MySQL语句时一定要把这个区别铭记在心。</p>
</li>
<li><p>在MySQL的SELECT语句中，可使用<strong>Concat()函数</strong>来拼接两个列。</p>
<p><code>SELECT Concat(vend_name, &#39;(&#39;, vend_country, ’)&#39;)</code></p>
<p>返回例如： ACME(USA)</p>
</li>
<li><p>删除数据右侧多余的空格来整理数据，这可以使用MySQL的<strong>RTrim()</strong>函数来完成</p>
<p><code>SELECT Concat( RTrim(vend_name) , &#39;(&#39;, RTrim(vend_country), ’)&#39;)</code></p>
</li>
<li><p>RTrim()函数去掉值右边的所有空格，LTrim()去掉串左边的空格以及<br>Trim()去掉串左右两边的空格。</p>
</li>
<li><p>使用别名<strong>AS</strong></p>
<p><code>SELECT Concat( RTrim(vend_name) , &#39;(&#39;, RTrim(vend_country), ’)&#39;) AS ven_title</code></p>
<p><strong>别名的其他用途：</strong>别名还有其他用途。常见的用途包括在实际的表列名包含<u>不符合规定的字符（如空格）时重新命名它</u>，在原来的名字<u>含混或容易误解</u>时扩充它，等等。</p>
</li>
</ul>
</li>
<li><p>执行算数计算</p>
<p><code>SELECT quantity*item_price AS expanded_price</code></p>
<p>输出中显示的expanded_price列为一个计算字段，此计算为<br>quantity*item_price。客户机应用现在可以使用这个新计算列，就像使用其他列一样。</p>
</li>
</ol>
<h2 id="chapter-11-使用数据处理函数"><a href="#chapter-11-使用数据处理函数" class="headerlink" title="chapter 11 使用数据处理函数"></a>chapter 11 使用数据处理函数</h2><ol>
<li><p>文本处理函数p81</p>
<ul>
<li>Upper()将文本转换为大写</li>
<li>Soundex() 将任何文本串转换为描述其语音表示的字母数字模式的算法</li>
</ul>
</li>
<li><p>日期和时间处理函数</p>
<ul>
<li><p>日期必须为格式yyyy-mm-dd，比如2005年9月1日，给出为2005-09-01</p>
<p><code>WHERE order_date = &#39;2005-09-01&#39;</code></p>
<p>但有可能存储的order_date 值为2005-09-01 11:30:05，则WHERE order_date = ‘2005-09-01’失败。</p>
<p>所以用<code>WHERE Date(order_date) = &#39;2005-09-01&#39;</code></p>
</li>
<li><p>匹配日期范围</p>
<ul>
<li><p><code>WHERE Date(order_date) = BETWEEN &#39;2005-09-01&#39; AND &#39;2008-09-01&#39;</code></p>
</li>
<li><p><code>WHERE Year(order_date) = 2005 AND Month(order_date) =9 ;</code></p>
<p>Year()是一个从日期（或日期时间）中返回年份的函数。<br>Month()从日期中返回月份</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>数值处理函数</p>
<p>一般主要用于代数、三角或几何运算</p>
<p>比如Abs(),Cos(ss)</p>
</li>
</ol>
<h2 id="chapter12-汇总数据"><a href="#chapter12-汇总数据" class="headerlink" title="chapter12 汇总数据"></a>chapter12 汇总数据</h2><ol>
<li><p>聚集函数</p>
<ul>
<li><p>AVG() 返回某列平均值</p>
<p><strong>只用于单个列：</strong>AVG()只能用来确定特定数值列的平均值，而且列名必须作为函数参数给出。为了获得多个列的平均值，必须使用多个AVG()函数。AVG()函数忽略列<strong>值为NULL的行</strong>。</p>
</li>
<li><p>COUNT() 某列的行数</p>
<ul>
<li>使用<strong>COUNT(*)</strong>对表中行的数目进行计数，不管表列中包含的是空<br>值（NULL）还是非空值。</li>
<li>使用<strong>COUNT(column)</strong>对特定列中<u>具有值的行</u>进行计数，忽略<br>NULL值。</li>
<li>如果指定列名，则指定列的值为空的行被COUNT()函数忽略，但如果COUNT()函数中用的是星号（*），则不忽略。</li>
</ul>
</li>
<li><p>MAX() 某列最大值</p>
<ul>
<li>在用于<strong>文本数据</strong>时，如果数据按相应的列排序，则MAX()返回最后一行。</li>
<li>MAX()函数<strong>忽略列值为NULL</strong>的行。</li>
</ul>
</li>
<li><p>MIN() 某列最小值</p>
<ul>
<li>在用于文本数据时，如果数据按相应的列排序，则MIN()返回最前面的行。</li>
<li>忽略列值为NULL**的行。</li>
</ul>
</li>
<li><p>SUM()  某列值之和</p>
<ul>
<li><p>SUM()也可以用来合计计算值，比如</p>
<p><code>SELECT SUM(item_price*quantity) AS total_price</code></p>
</li>
<li><p>SUM()函数忽略列值为NULL的行。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>聚集不同值</p>
<ul>
<li><p>默认是ALL，但可用DISTINCT，比如 <code>SELECT (DISTINCT prod_price) AS avg_price</code></p>
</li>
<li><p>如果指定列名，则DISTINCT只能用于COUNT(),不能用于COUNT(*)</p>
</li>
<li><p>DISTINCT必须使用列名，不能用于计算或表达式</p>
</li>
</ul>
</li>
<li><p>组合聚集函数</p>
<p>SELECT语句可根据需要包含多个聚集函数</p>
</li>
</ol>
<h2 id="chapter13-分组数据"><a href="#chapter13-分组数据" class="headerlink" title="chapter13 分组数据"></a>chapter13 分组数据</h2><ol>
<li><p>数据分组</p>
</li>
<li><p>创建分组<strong>GROUP BY子句</strong></p>
<p>分组是在SELECT语句的<strong>GROUP BY</strong>子句中建立的。</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565712091949.png" alt="1565712091949"></p>
</li>
</ol>
<p>GROUP BY子句指示MySQL按vend_id排序并分组数据。这导致<strong>对每个vend_id而不是整个表计算num_prods一次</strong>。从输出中可以看到，供应商1001有3个产品，供应商<br>1002有2个产品，供应商1003有7个产品，而供应商1005有2个产品。</p>
<p>GROUP BY子句指示MySQL分组数据，然后<strong>对每个组而不是整个结果集进行聚集</strong>。</p>
<ul>
<li>GROUP BY子句可以包含任意数目的列。这使得能对分组进行嵌套，为数据分组提供更细致的控制。</li>
<li>如果在GROUP BY子句中嵌套了分组，数据将在最后规定的分组上进行汇总。换句话说，在建立分组时，指定的所有列都一起计算（所以不能从个别的列取回数据）。</li>
<li><strong>GROUP BY子句中</strong>列出的每个列都必须是检索列或有效的表达式（<strong>但不能是聚集函数</strong>）。如果在SELECT中使用表达式，则必须在GROUP BY子句中指定相同的表达式。不能使用别名。</li>
<li>除聚集计算语句外，SELECT语句中的每个列都必须在GROUP BY子句中给出。</li>
<li>如果分组列中具有NULL值，则<strong>NULL将作为一个分组返回</strong>。如果列中有多行NULL值，它们将分为一组。</li>
<li>GROUP BY子句必须出现在<strong>WHERE子句之后，ORDER BY子句之前</strong>。</li>
</ul>
<ol start="3">
<li><p>过滤分组<strong>HAVING子句</strong></p>
<p>事实上，目前为止所学过的所有类型的WHERE子句都可以用HAVING来替代。唯一的差别是<strong>WHERE过滤行，而HAVING过滤分组。</strong></p>
<p><strong>WHERE在数据分组前进行过滤，HAVING在数据分组后进行过滤，</strong>WHERE排除的行不包括在分组中。这可能会改变计算值，从而影响HAVING子句中基于这些值过滤掉的分组。</p>
<p>它列出具有2个（含）以上、价格为10（含）以上的产品的供应商：</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565712997819.png" alt="1565712997819"></p>
<p>​    如果没有where：</p>
</li>
</ol>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565713045472.png" alt="1565713045472"></p>
<blockquote>
<p>如果要对分组后的数据进行什么聚集操作，则group by 后跟着having</p>
</blockquote>
<ol start="4">
<li><p>分组和排序</p>
<p>检索总计订单价格大于等于50的订单的订单号和按总计订单价格排序：</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565713251518.png" alt="1565713251518"></p>
</li>
<li><p>SELECT子句顺序</p>
<p>SELECT</p>
<p>FROM</p>
<p>WHERE</p>
<p>GROUP BY</p>
<p>HAVING</p>
<p>ORDER BY</p>
<p>LIMIT</p>
</li>
</ol>
<h2 id="CHAPTER14-使用子查询"><a href="#CHAPTER14-使用子查询" class="headerlink" title="CHAPTER14 使用子查询"></a>CHAPTER14 使用子查询</h2><ol>
<li><p>子查询</p>
</li>
<li><p>利用子查询进行过滤</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">WHERE</span> order_num <span class="keyword">IN</span> (<span class="keyword">SELECT</span> order_num</span><br><span class="line">					<span class="keyword">FROM</span> orderitems</span><br><span class="line">					<span class="keyword">WHERE</span> prod_id = <span class="string">'TNT2'</span>);</span><br></pre></td></tr></table></figure>

<p><strong>列必须匹配</strong> ：在WHERE子句中使用子查询，应该保证SELECT语句具有与WHERE子句中相同数目的列。通常，子查询将返回单个列并且与单个列匹配，但如果需要也可以使用多个列。</p>
</li>
<li><p>作为计算字段使用子查询</p>
<p>假如需要显示customers表中每个客户的订单总数。订单与相应的客户ID存储在orders表中。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name,</span><br><span class="line">	   cust_state,</span><br><span class="line">	   (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</span><br><span class="line">	    <span class="keyword">FROM</span> orders</span><br><span class="line">	    <span class="keyword">WHERE</span> orders.cust_id = customers.cust_id) <span class="keyword">AS</span> orders</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name;</span><br></pre></td></tr></table></figure>

<p>该子查询对检索出的每个客户执行一次。</p>
</li>
</ol>
<h2 id="chapter15-联结表"><a href="#chapter15-联结表" class="headerlink" title="chapter15 联结表"></a>chapter15 联结表</h2><ol>
<li><p>联结</p>
<ul>
<li><p>关系表</p>
<p><strong>外键（foreign key）</strong> 外键为某个表中的一列，它包含另一个表的主键值，定义了两个表之间的关系。</p>
</li>
</ul>
</li>
<li><p>创建联结</p>
<p>规定要联结的所有表以及它们如何关联即可</p>
<p><strong>完全限定列名</strong> 在引用的列可能出现二义性时，必须使用完全限定列名（用一个点分隔的表名和列名）。如果引用一个没有用表名限制的具有二义性的列名，MySQL将返回错误</p>
<ul>
<li><p>WHERE</p>
<ul>
<li><p>由没有联结条件的表关系返回的结果为<strong>笛卡儿积</strong>。检索出的行的数目将是第一个表中的行数乘以第二个表中的行数。（from里有2个表名）</p>
</li>
<li><p>应该保证所有联结都有WHERE子句</p>
</li>
</ul>
</li>
<li><p>内部联结<strong>INNER JOIN</strong></p>
<p><code>FROM table1 INNER JOIN table2 ON table1.col1 = table2.col1;</code></p>
<p> 在使用这种语法时，联结条件用特定的<strong>ON子句</strong>而不是WHERE子句给出。传递给ON的实际条件与传递给WHERE的相同。</p>
</li>
<li><p>联结多个表</p>
<p>使用多个where子句条件，用AND</p>
</li>
</ul>
</li>
</ol>
<h2 id="chapter16-创建高级联结"><a href="#chapter16-创建高级联结" class="headerlink" title="chapter16 创建高级联结"></a>chapter16 创建高级联结</h2><ol>
<li><p>使用表别名</p>
<p><code>FROM customers AS c</code></p>
<p>表别名只在查询执行中使用。与列别名不一样，表别名不返回到客户机。</p>
</li>
<li><p>使用不同类型的联结</p>
<ul>
<li><p>自联结</p>
<p>假如你发现某物品（其ID为DTNTR）存在问题，因此想知道生产该物<br>品的供应商生产的其他物品是否也存在这些问题。此查询要求首先找到<br>生产ID为DTNTR的物品的供应商，然后找出这个供应商生产的其他物品。</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565715177143.png" alt="1565715177143"></p>
<p>需要的两个表实际上是相同的表，因此products表在FROM子句中出现了两次。为解决此问题，使用了表别名。</p>
<p>WHERE（通过匹配p1中的vend_id和p2中的vend_id）首先联结两个表，然后按第二个表中的prod_id过滤数据，返回所需的数据。</p>
<p><strong>用自联结而不用子查询</strong> 自联结通常作为外部语句用来替代从相同表中检索数据时使用的子查询语句。虽然最终的结果是相同的，但有时候处理联结远比处理子查询快得多。</p>
</li>
<li><p>自然联结</p>
<p>自然联结排除多次出现，使每个列只返回一次</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565715862096.png" alt="1565715862096"></p>
</li>
<li><p>外部联结<strong>OUTER JOIN</strong></p>
<p>许多联结将一个表中的行与另一个表中的行相关联。但有时候会需要包含没有关联行的那些行</p>
<p>在使用OUTER JOIN语法时，必须使用<strong>RIGHT或LEFT关键字</strong>指定<strong>包括其所有行的表</strong>（RIGHT指出的是OUTER JOIN右边的表，而LEFT指出的是OUTER JOIN左边的表）</p>
</li>
<li><p>使用带聚集函数的联结</p>
<p>检索所有客户及每个客户所下的订单数</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565716203378.png" alt="1565716203378"></p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565716251010.png" alt="1565716251010"></p>
<p>这个例子使用左外部联结来包含所有客户，甚至包含那些没有任何下订单的客户。结果显示也包含了客户Mouse House，它有0个订单。</p>
</li>
<li><p>使用联结和联结条件</p>
</li>
</ul>
</li>
</ol>
<h2 id="chapter17-组合查询"><a href="#chapter17-组合查询" class="headerlink" title="chapter17 组合查询"></a>chapter17 组合查询</h2><ol>
<li><p>组合查询</p>
<p>允许执行多个查询（多条SELECT语句），并将结果作为单个查询结果集返回。这些组合查询通常称为并（union）或复合查询（compound query）</p>
</li>
<li><p>创建组合查询  UNION</p>
<p> 相当于“并”， 也可以在where里用or。</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565838715955.png" alt="1565838715955"></p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565838736215.png" alt="1565838736215"></p>
<ul>
<li>UNION从查询结果集中自动去除了重复的行，如果想返回所有匹配行，可使用UNION ALL而不是UNION</li>
<li>在用UNION组合查询时，<strong>只能使用一条ORDER BY子句，它必须出现在最后一条SELECT语句之后</strong>。对于结果集，不存在用一种方式排序一部分，而又用另一种方式排序另一部分的情况，因此不允许使用多条ORDER BY子句。但实际上MySQL将用它来排序所有SELECT语句返回的所有结果。</li>
</ul>
</li>
</ol>
<h2 id="chapter18-全文本搜索"><a href="#chapter18-全文本搜索" class="headerlink" title="chapter18  全文本搜索"></a>chapter18  全文本搜索</h2><ol>
<li><p>理解全文本搜索</p>
<p>和LIKE的功能差不多</p>
</li>
<li><p>使用全文本搜索</p>
<p>在create table的时候用FULLTEXT子句给出要全文搜索的列<code>FULLTEXT(note_text)</code></p>
<ul>
<li>进行全文本搜索</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> note_text</span><br><span class="line"><span class="keyword">FROM</span> productnotes</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text) Against(<span class="string">'rabbit'</span>);</span><br></pre></td></tr></table></figure>

<p>Match(note_text)指示MySQL针对指定的列进行搜索，Against(‘rabbit’)指定词rabbit作为搜索文本。确实包含词rabbit的两个行每行都有一个等级值，<strong>文本中词靠前的行的等级值比词靠后的行的等级值高。</strong></p>
<p><strong>使用完整的Match() 说明</strong> 传递给Match() 的值必须与FULLTEXT()定义中的相同。如果指定多个列，则必须列出它们（而且次序正确）。</p>
<p><strong>搜索不区分大小写</strong> 除非使用BINARY方式,否则全文本搜索不区分大小写。</p>
<p><strong>排序多个搜索项</strong> 如果指定多个搜索项，则<strong>包含多数匹配词</strong>的那些行将具有比包含较少词（或仅有一个匹配）的那些行高的等级值。</p>
<ul>
<li><p>使用查询扩展 WITH QUERY EXPANSION</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> note_text</span><br><span class="line"><span class="keyword">FROM</span> productnotes</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text) Against(<span class="string">'anvils'</span> <span class="keyword">WITH</span> <span class="keyword">QUERY</span> EXPANSION);</span><br></pre></td></tr></table></figure>

<p>这次返回了7行。第一行包含词anvils，因此等级最高。<strong>第二行与anvils无关，但因为它包含第一行中的两个词（customer和recommend），所以也被检索出来</strong>。第3行也包含这两个相同的词，但它们在文本中的位置更靠后且分开得更远，因此也包含这一行，但等级为第三。第三行确实也没有涉及anvils（按它们的产品名）。</p>
</li>
<li><p>布尔文本搜索 IN BOOLEAN MODE</p>
<p><strong>即使没有FULLTEXT索引也可以使用</strong> 布尔方式不同于迄今为止使用的全文本搜索语法的地方在于， 即使没有定义FULLTEXT索引，也可以使用它。但这是一种非常缓慢的操作（其性能将随着数据量的增加而降低）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> note_text</span><br><span class="line"><span class="keyword">FROM</span> productnotes</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">Match</span>(note_text) Against(<span class="string">'heavy  -rope*'</span> <span class="keyword">IN</span> <span class="built_in">BOOLEAN</span> <span class="keyword">MODE</span>);</span><br></pre></td></tr></table></figure>

<p>匹配包含heavy但不包含任意以rope开始的词的行</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565840186859.png" alt="1565840186859"></p>
</li>
</ul>
<p>说明：</p>
<ul>
<li>在索引全文本数据时，短词被忽略且从索引中排除。短词定义为那些具有3个或3个以下字符的词（如果需要，这个数目可以更改）。</li>
<li>MySQL带有一个内建的非用词（stopword）列表，这些词在索引全文本数据时总是被忽略。如果需要，可以覆盖这个列表</li>
<li>许多词出现的频率很高，搜索它们没有用处（返回太多的结果）。因此，MySQL规定了一条<strong>50%规则</strong>，如果一个词出现在50%以上的行中，则将它作为一个非用词忽略。50%规则不用于IN BOOLEANMODE。</li>
<li>如果表中的行数少于3行，则全文本搜索不返回结果（因为每个词或者不出现，或者至少出现在50%的行中）。</li>
<li>忽略词中的单引号。例如，don’t索引为dont</li>
<li>不具有词分隔符（包括日语和汉语）的语言不能恰当地返回全文本搜索结果。</li>
<li>仅在MyISAM数据库引擎中支持全文本搜索</li>
<li>没有邻近操作符</li>
</ul>
</li>
</ol>
<h2 id="chapter19-插入数据"><a href="#chapter19-插入数据" class="headerlink" title="chapter19  插入数据"></a>chapter19  插入数据</h2><ol start="2">
<li><p>插入完整的行</p>
<ul>
<li>按照列的顺序插入数据</li>
</ul>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565840581796.png" alt="1565840581796"></p>
<ul>
<li>给出列名插入数据</li>
</ul>
</li>
</ol>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565840664625.png" alt="1565840664625"></p>
<p>​        不管使用哪种INSERT语法，都必须给出VALUES的正确数目。如果不提供列名，        则必须给每个表列提供一个值。如果提供列名，则必须对每个列出的列给出一        个值。如果不这样，将产生一条错误消息，相应的行插入不成功。</p>
<p>​    省略列： 1.该列定义为<strong>允许NULL值</strong>（无值或空值）。</p>
<p>​                    2. 在表定义中给出<strong>默认值</strong>。这表示如果不给出值，将使用默认值。</p>
<p>​    <strong>提高整体性能</strong>：降低INSERT语句的优先级 <code>INSERT LOW_PRIORITY INTO</code></p>
<ol start="3">
<li><p>插入多个行</p>
<p>多条INSERT语句，用；隔开</p>
<p>或者如果列的顺序相同，则可以VALUES后面跟多个（），用，隔开</p>
</li>
<li><p>插入检索出的数据</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565841297599.png" alt="1565841297599"></p>
<p>​        使用INSERT SELECT从custnew中将所有数据导入customers</p>
</li>
</ol>
<h2 id="chapter-20-更新和删除数据"><a href="#chapter-20-更新和删除数据" class="headerlink" title="chapter 20 更新和删除数据"></a>chapter 20 更新和删除数据</h2><ol>
<li><p>更新数据</p>
<p>客户10005现在有了电子邮件地址，因此他的记录需要更新</p>
<p>UPDATE语句总是以要更新的表的名字开始。</p>
<p>SET：多个列之间用’,’，最后一列之后不用逗号</p>
<p>即使是发生错误，也继续进行更新，可使用IGNORE关键字<code>UPDATE IGNORE table</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">table</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> col1= <span class="keyword">value</span>, col2 = v2</span><br><span class="line"></span><br><span class="line"><span class="keyword">WHERE</span> condition</span><br></pre></td></tr></table></figure>





</li>
</ol>
<p>   <img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565841456741.png" alt="1565841456741"></p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565841958500.png" alt="1565841958500"></p>
<ol start="2">
<li><p>删除数据</p>
<p><strong>DELETE删除整行</strong>而不是删除列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="number">10006</span>;</span><br></pre></td></tr></table></figure>

<p>为了删除指定的列，使用UPDATE语句。</p>
</li>
</ol>
<h2 id="chapter-21-创建和操纵表"><a href="#chapter-21-创建和操纵表" class="headerlink" title="chapter 21 创建和操纵表"></a>chapter 21 创建和操纵表</h2><ol>
<li><p>创建表</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565842221998.png" alt="1565842221998"></p>
</li>
</ol>
<p>每个表只允许一个AUTO_INCREMENT列</p>
<p>如何在使用AUTO_INCREMENT列时获得这个值呢？可使用<strong>last_insert_id()</strong>函数获得这个值</p>
<p>使用默认值</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565842366822.png" alt="1565842366822"></p>
<p>以下是几个需要知道的引擎：</p>
<ul>
<li>InnoDB是一个可靠的事务处理引擎（参见第26章），它不支持全文<br>本搜索；</li>
<li>MEMORY在功能等同于MyISAM，但由于数据存储在内存（不是磁盘）<br>中，速度很快（特别适合于临时表）；</li>
<li>MyISAM是一个性能极高的引擎，它支持全文本搜索（参见第18章），<br>但不支持事务处理。</li>
</ul>
<p><strong>外键不能跨引擎</strong> <strong>混用引擎类型</strong>有一个大缺陷。外键（用于强制实施引用完整性，如第1章所述）不能跨引擎，即<u>使用一个引擎的表不能引用具有使用不同引擎的表的外键</u>。</p>
<ol start="2">
<li><p>更新表ALTER</p>
<p>添加一个列：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> vendors</span><br><span class="line"><span class="keyword">ADD</span> vend_phone <span class="built_in">CHAR</span>(<span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<p>删除一个列：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> vendors</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">COLUMN</span> vend_phone;</span><br></pre></td></tr></table></figure>

<p>定义外键：</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565842734801.png" alt="1565842734801"></p>
</li>
</ol>
<ol start="3">
<li><p>删除表</p>
<p><code>DROP TABLE name;</code></p>
</li>
<li><p>重命名表</p>
<p><code>RENAME TABLE name1 TO name2;</code></p>
</li>
</ol>
<h2 id="chapter-22-使用视图"><a href="#chapter-22-使用视图" class="headerlink" title="chapter 22 使用视图"></a>chapter 22 使用视图</h2><p>为什么使用视图</p>
<ul>
<li>重用SQL语句。</li>
<li>简化复杂的SQL操作。在编写查询后，可以方便地重用它而不必<br>知道它的基本查询细节。</li>
<li>使用表的组成部分而不是整个表。</li>
<li>保护数据。可以给用户授予表的特定部分的访问权限而不是整个<br>表的访问权限。</li>
<li>更改数据格式和表示。视图可返回与底层表的表示和格式不同的<br>数据。</li>
</ul>
<p>规则：</p>
<ul>
<li>ORDER BY可以用在视图中，但如果从该视图检索数据SELECT中也<br>含有ORDER BY，那么该视图中的ORDER BY将被覆盖。</li>
<li>视图不能索引，也不能有关联的触发器或默认值。</li>
</ul>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565843405018.png" alt="1565843405018"></p>
<p>用视图重新格式化检索出的数据</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565843462684.png" alt="1565843462684"></p>
<p>用视图过滤不想要的数据</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565843499649.png" alt="1565843499649"></p>
<p>使用视图与计算字段</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565843542002.png" alt="1565843542002"></p>
<p>相当于就是把之前很复杂的sql语句的结果存到view里了，以后直接用view就很方便。</p>
<h2 id="chapter23-使用存储过程"><a href="#chapter23-使用存储过程" class="headerlink" title="chapter23 使用存储过程"></a>chapter23 使用存储过程</h2><p>可以创建存储过程。存储过程简单来说，就是为以后的使用而保存的一条或多条MySQL语句的集合。可将其视为批文件，虽然它们的作用不仅限于批处理。</p>
<p>创建存储过程</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844081574.png" alt="1565844081574"></p>
<p>使用这个存储过程</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844122044.png" alt="1565844122044"></p>
<p>删除存储过程</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844156310.png" alt="1565844156310"></p>
<ul>
<li>使用参数</li>
</ul>
<p><strong>变量</strong>（variable）内存中一个特定的位置，用来临时存储数据。</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844927380.png" alt="1565844927380"></p>
<p>调用此修改过的存储过程，必须指定3个变量名</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565844962001.png" alt="1565844962001"></p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845018878.png" alt="1565845018878"></p>
<ul>
<li>使用IN,OUT参数</li>
</ul>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845120999.png" alt="1565845120999"></p>
<p>调用存储过程</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845176197.png" alt="1565845176197">时</p>
<ul>
<li><p>建立智能存储过程</p>
<p>用<strong>DECLARE语句定义局部变量</strong>，用到了IF语句</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845459041.png" alt="1565845459041"></p>
</li>
</ul>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845478087.png" alt="1565845478087"></p>
<p>调用过程</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845533107.png" alt="1565845533107"></p>
<p>检查存储过程</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565845716642.png" alt="1565845716642"></p>
<h2 id="chapter-24-使用游标"><a href="#chapter-24-使用游标" class="headerlink" title="chapter 24 使用游标"></a>chapter 24 使用游标</h2><p>游标（cursor）是一个存储在MySQL服务器上的数据库查询，它不是一条SELECT语句，而是被该语句检索出来的结果集。</p>
<p>游标主要用于<strong>交互式应用</strong>，其中用户需要滚动屏幕上的数据，并对<br>数据进行浏览或做出更改。</p>
<ol>
<li><p>创建游标CURSOR</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> processorders()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> ordernumbers <span class="keyword">CURSOR</span></span><br><span class="line">	<span class="keyword">FOR</span></span><br><span class="line">	<span class="keyword">SELECT</span> order_num <span class="keyword">FROM</span> orders;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>打开和关闭游标</p>
<p><code>OPEN ordernumbers;</code></p>
<p><code>CLOSE ordernumbers;</code></p>
</li>
</ol>
</li>
</ol>
<h2 id="chapter-25-使用触发器"><a href="#chapter-25-使用触发器" class="headerlink" title="chapter 25 使用触发器"></a>chapter 25 使用触发器</h2><p>当进行加删更新的时候，自动触发执行</p>
<ol>
<li><p>创建触发器</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> newproduct AFTRE <span class="keyword">INSERT</span> <span class="keyword">ON</span> products</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span> <span class="keyword">SELECT</span> <span class="string">'Product added'</span>;</span><br></pre></td></tr></table></figure>

<p>文本Product added将对每个插入的行显示一次</p>
<p>触发器有after 和before</p>
</li>
<li><p>删除触发器</p>
<p><code>DROP TRIGGER newproduct;</code></p>
<p>触发器不能更新或覆盖。为了修改一个触发器，<strong>必须先删除它</strong>，然后再重新创建。</p>
</li>
<li><p>使用触发器</p>
<ul>
<li><p>INSERT触发器</p>
<ul>
<li><p>在INSERT触发器代码内，可引用一个名为<strong>NEW的虚拟表</strong>，访问被插入的行；</p>
</li>
<li><p>对于<strong>AUTO_INCREMENT</strong>列，NEW在INSERT执行之前包含0，在INSERT<br>执行之后包含新的自动生成值</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565846803676.png" alt="1565846803676"></p>
</li>
<li><p>所以每次插入数据之后自动返回order_num</p>
</li>
</ul>
</li>
<li><p>DELETE 触发器</p>
<ul>
<li><p>在DELETE触发器代码内，你可以引用一个名为<strong>OLD的虚拟表</strong>，访问被删除的行</p>
</li>
<li><p>OLD中的值全都是只读的，不能更新。</p>
<p>使用OLD保存将要被删除的行到一个存档表中：</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565847033790.png" alt="1565847033790"></p>
</li>
<li><p><strong>多语句触发器</strong> 正如所见，触发器deleteorder使用BEGIN和<br>END语句标记触发器体。这在此例子中并不是必需的，不过也<br>没有害处。使用<strong>BEGIN END块</strong>的好处是触发器能容纳多条SQL<br>语句（在BEGIN END块中一条挨着一条）。</p>
</li>
</ul>
</li>
<li><p>UPDATE触发器</p>
<ul>
<li>在UPDATE触发器代码中，你可以引用一个名为OLD的虚拟表访问<br>以前（UPDATE语句前）的值，引用一个名为NEW的虚拟表访问新<br>更新的值；</li>
<li>在BEFORE UPDATE触发器中，NEW中的值可能也被更新（允许更改<br>将要用于UPDATE语句中的值）；</li>
<li>OLD中的值全都是只读的，不能更新。</li>
</ul>
<p>e.g. 保证州名缩写总是大写，set NEW里的值</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565847346777.png" alt="1565847346777"></p>
</li>
</ul>
</li>
</ol>
<p>应该用触发器来保证<strong>数据的一致性（大小写、格式等）</strong>。在触发器中执行这种类型的处理的优点是它<strong>总是进行这种处理</strong>，而且是透明地进行，与客户机应用无关。</p>
<p>触发器的一种非常有意义的使用是<strong>创建审计跟踪</strong>。使用触发器，把更改（如果需要，甚至还有之前和之后的状态）记录到另一个表非常容易。</p>
<p>要新加入的值先存到new里，改new的值即可。</p>
<h2 id="chapter-26-管理事务处理"><a href="#chapter-26-管理事务处理" class="headerlink" title="chapter 26 管理事务处理"></a>chapter 26 管理事务处理</h2><p>COMMIT 和 ROLLBACK</p>
<p><strong>事务处理（transaction processing）</strong>可以用来维护数据库的完整性，它保证成批的MySQL操作要么完全执行，要么完全不执行。</p>
<p>比如客户table和订单table，加入客户之后还没把相关信息加入order，就会导致客户信息不完整，所以要用事务处理。</p>
<p> 事务（transaction）指一组SQL语句；<br> 回退（rollback）指撤销指定SQL语句的过程；<br> 提交（commit）指将未存储的SQL语句结果写入数据库表；<br> 保留点（savepoint）指事务处理中设置的临时占位符（placeholder），你可以对它发布回退（与回退整个事务处理不同）。</p>
<ol>
<li><p>控制事务处理</p>
<ul>
<li><p>标识事务开始</p>
<p><code>START TRANSACTION</code></p>
</li>
<li><p>使用ROLLBACK</p>
<ul>
<li><p>ROLLBACK只能在一个事务处理内使用（<strong>在执行一条START TRANSACTION命令之后</strong>）。</p>
</li>
<li><p>事务处理用来管理INSERT、UPDATE和DELETE语句。你不能回退SELECT，CREATE, DROP语句。</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565856341486.png" alt="1565856341486"></p>
</li>
</ul>
</li>
<li><p>使用<strong>COMMIT</strong>提交</p>
<p>使用事务处理块来保证订单不被部分删除。最后的COMMIT语句仅在不出错时写出更改。如果第一条DELETE起作用，但第二条失败，则DELETE不会提交（实际上，它是被自动撤销的）。</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565856449366.png" alt="1565856449366"></p>
</li>
<li><p><strong>隐含事务关闭</strong> 当COMMIT或ROLLBACK语句执行后，事务会自动关闭（将来的更改会隐含提交）。</p>
</li>
<li><p>使用保留点</p>
<p>部分提交或回退</p>
<ul>
<li><p>创建占位符，即保留点</p>
<p><code>SAVEPOINT deletel;</code></p>
</li>
<li><p>回退到保留点</p>
<p><code>ROLLBACK TO deletel;</code></p>
</li>
<li><p>释放保留点，也可以执行一条ROLLBACK或COMMIT）后<strong>自动释放</strong></p>
<p><code>RELEASE SAVEPOINT deletel;</code></p>
</li>
</ul>
</li>
<li><p>更改默认的提交行为</p>
<p><code>SET autocommit =0</code></p>
</li>
</ul>
</li>
</ol>
<h2 id="chapter27-全球化和本地化"><a href="#chapter27-全球化和本地化" class="headerlink" title="chapter27 全球化和本地化"></a>chapter27 全球化和本地化</h2><h2 id="chapter28-安全管理"><a href="#chapter28-安全管理" class="headerlink" title="chapter28 安全管理"></a>chapter28 安全管理</h2><ol>
<li><p>访问控制</p>
<p>MySQL用户账号和信息存储在名为mysql的MySQL数据库中。一般不需要直接访问mysql数据库和表</p>
</li>
<li><p>管理用户</p>
<ol>
<li><p>创建用户</p>
<p><code>CREATE USER ben IDENTIFIED BY &#39;pa$$w0rd&#39;;</code></p>
<p>CREATE USER创建一个新用户账号。在创建用户账号时不一定需要口令，不过这个例子用IDENTIFIED BY ‘p@$$wOrd’给出了一个口令。</p>
</li>
<li><p>重命名用户</p>
<p><code>RENAME USER benTO bforta;</code></p>
</li>
<li><p>删除用户</p>
<p><code>DROP USER bforta;</code></p>
</li>
<li><p>设置访问权限</p>
<p>新创建的用户账号没有访问权限。它们能登录MySQL，但不能看到数据，不能执行任何数据库操作</p>
<p><img src="C:%5CUsers%5Chuang%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565857887624.png" alt="1565857887624"></p>
<p><strong>GRANT和REVOKE</strong>可在几个层次上控制访问权限：<br> 整个服务器，使用GRANT ALL和REVOKE ALL；<br> 整个数据库，使用ON database.*；<br> 特定的表，使用ON database.table；<br> 特定的列；<br> 特定的存储过程。</p>
<p><code>GRANT SELECT ON database.* TO bforta;</code>只读访问权限</p>
<p>database数据库的所有表</p>
<p><code>REVOKE SELECT ON database.* FROM bforta;</code></p>
<p><code>GRANT SELECT,INSERT  ON database.* TO bforta;</code></p>
</li>
<li><p>更改口令</p>
<p><code>SET PASSWORD FOR bforta  = Password(&#39;n32 p@$$w0re&#39;);</code></p>
<p>在不指定用户名时，SET PASSWORD更新当前登录用户的口令。</p>
</li>
</ol>
</li>
</ol>
<h2 id="chapter29-数据库维护"><a href="#chapter29-数据库维护" class="headerlink" title="chapter29 数据库维护"></a>chapter29 数据库维护</h2><h2 id="chapter30-改善性能"><a href="#chapter30-改善性能" class="headerlink" title="chapter30 改善性能"></a>chapter30 改善性能</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/21/note of MySQL/" data-id="cjzl0rn0f000nj4lbnadkm8uz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/">MySQL</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/08/21/KeyMiner Discovering Keys for Graphs/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          KeyMiner Discovering Keys for Graphs
        
      </div>
    </a>
  
  
    <a href="/2019/08/03/word embedding/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">word embedding</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/">Machine Learning</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/paper/">paper</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Entity-Matching/">Entity Matching</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/key/">key</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/word-embedding/">word embedding</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Entity-Matching/" style="font-size: 10px;">Entity Matching</a> <a href="/tags/MySQL/" style="font-size: 20px;">MySQL</a> <a href="/tags/key/" style="font-size: 10px;">key</a> <a href="/tags/word-embedding/" style="font-size: 10px;">word embedding</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/08/21/MySQL优化索引/">MySQL索引优化</a>
          </li>
        
          <li>
            <a href="/2019/08/21/KeyMiner Discovering Keys for Graphs/">KeyMiner Discovering Keys for Graphs</a>
          </li>
        
          <li>
            <a href="/2019/08/21/note of MySQL/">note of MySQL</a>
          </li>
        
          <li>
            <a href="/2019/08/03/word embedding/">word embedding</a>
          </li>
        
          <li>
            <a href="/2019/08/03/Deep Learning for Entity Matching A Design Space Exploration/">Deep Learning for Entity Matching A Design Space Exploration</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 HJJing<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>